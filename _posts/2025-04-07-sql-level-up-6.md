---
title: 6장 정리 - (18강)
description: 결합
# author: d_o0o_b
categories: [Reading, SQL-Level-Up]
tags: [typography]
# pin: true
math: true
mermaid: true
---

## 18강: 기능적 관점으로 구분하는 결합의 종류
SQL에는 다양한 종류의 결합이 존재한다. 대표적으로 다음과 같다.

- 크로스 결합 (Cross Join)
- 내부 결합 (Inner Join)
- 외부 결합 (Outer Join)
- 자기 결합 (Self Join)
- 등가/비등가 결합 (Equi/Non-equi Join)
- 자연 결합 (Natural Join)

이 중 기능적 관점에서 중요한 세 가지는 크로스, 내부, 외부 결합이다. 이들은 생성되는 결과 형태에 따라 구분되며, 상호 배타적이다. 예를 들어, 내부 결합이면서 외부 결합일 수는 없다.

반면, 등가/비등가 결합은 결합 조건의 형태에 따른 구분이다. 등호(=)를 사용하면 등가 결합, 부등호(>, < 등)를 사용하면 비등가 결합이 된다. 따라서 외부 결합이면서 비등가 결합인 경우도 존재할 수 있다.

자연 결합은 내부 결합이면서 등가 결합인 경우를 간결하게 표현한 것이다.

그렇다면 자기 결합은 어떤 위치일까? 자기 결합은 연산 방식이 아닌 **대상(같은 테이블)**에 따른 구분이다. 따라서 자기 결합은 크로스/내부/외부 결합 중 하나와 함께 사용되는 조합이다. 그렇기 때문에 기능적으로는 별도의 결합 유형으로 분류할 필요는 없다고 본다.

### 자연 결합
동작
- 같은 이름의 필드를 기준으로 자동으로 등가 조건을 설정해 결합한다.

장점
- 구문이 간단하다.

단점
- 필드 이름과 자료형이 같아야 한다.
- 필드 이름이 바뀌거나 확장될 경우 유지보수가 어렵다.
- 결합 조건이 명시되지 않아 가독성이 떨어진다.

결론
- 특별한 이유가 없다면 자연 결합보다는 내부 결합을 사용하는 것이 좋다.

### USING 구
자연 결합과 내부 결합의 중간 형태

특정 필드 이름으로 등가 결합을 할 때 ON 대신 USING(필드)을 사용할 수 있다.

필드명이 동일한 경우에만 사용 가능하다.

장점
- 자연 결합보다 가독성이 좋다.

단점
- 여전히 유연성은 떨어진다.



### 크로스 결합 - 모든 결합의 기초
동작
- 두 테이블의 가능한 모든 조합(데카르트 곱)을 반환한다.

레코드 수
- A 테이블의 행 수 × B 테이블의 행 수

실무 사용
- 거의 사용되지 않는다.

이유
- 그런 결과가 필요한 경우가 거의 없다.
- 결과 수가 많아 비용이 많이 드는 연산이다.

하지만 결합의 개념을 이해하기 위한 기초로서 중요하다.


### 내부 결합 (inner join) - 왜 '내부'라는 말을 사용할까?
동작 
- 두 테이블의 레코드 중 조건을 만족하는 조합만 반환한다.

이름의 유래
- 크로스 결합 결과의 **부분 집합(내부)**이라는 의미에서 유래되었다.

- 가장 많이 사용되는 결합

#### 상관 서브쿼리와의 비교
내부 결합은 상관 서브쿼리로도 대체할 수 있다.
하지만 상관 서브쿼리는 반복 실행되어 비용이 높다.


결론
- 일반적으로는 내부 결합을 사용하는 것이 효율적이다.



### 외부 결합 (outer join) - 왜 '외부'라는 말을 사용할까?
동작
- 조건에 맞는 레코드는 물론이고, 한쪽 테이블에만 존재하는 레코드도 NULL을 채워서 포함시킨다.

종류
- 왼쪽 외부 결합 (LEFT OUTER JOIN)
- 오른쪽 외부 결합 (RIGHT OUTER JOIN)
- 완전 외부 결합 (FULL OUTER JOIN)

내부 결합과의 차이
- 내부 결합은 조건 불충족 시 레코드를 제거
- 외부 결합은 조건 불충족 시에도 기준 테이블의 레코드를 유지

활용
- 키가 없는 데이터도 모두 보여줘야 하는 리포트 등에 자주 사용된다.


### 자기 결합 (self join)
동작
- 같은 테이블을 두 번 사용하여 결합하는 방식이다.

사용법
- 같은 테이블에 별칭(alias) 을 부여하여 사용한다.

의미
- 물리적으로는 같은 테이블이지만, 논리적으로는 다른 테이블과 결합하는 것처럼 다룬다.

자기 결합은 어떤 결합 방식과도 함께 사용 가능하다.

ex. 자기 결합 + 크로스 결합 / 자기 결합 + 내부 결합 등

### 정리

| 구분               | 특징               | 사용 여부           |
| :---------------- | :---------------- | :---------------- |
| 크로스 결합 | 모든 조합, 데카르트 곱, 비용 매우 큼 | 	거의 X |
| 내부 결합 | 조건 만족하는 레코드만, 가장 자주 사용 | 	✔️ |
| 외부 결합 | 조건 불만족 시에도 NULL 채워서 보존 | 	✔️ |
| 자연 결합 | 필드명이 같을 때 등가 조건 생략 가능, 사용 제한 많음 | 	거의 X |
| USING 구 | 자연 결합과 내부 결합의 중간, 가독성은 있으나 유연성 떨어짐 | 	제한적 사용 |
| 자기 결합 | 같은 테이블과 결합, 별칭 사용 | 	상황에 따라 사용 |