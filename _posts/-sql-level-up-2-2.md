---
title: 2장 정리 - 7강(완강)
description: SQL 기초
# author: d_o0o_b
categories: [Reading, SQL-Level-Up]
tags: [typography]
# pin: true
math: true
mermaid: true
---


## 7강: 조건 분기, 집합 연산, 윈도우 함수, 갱신

### SQL과 조건 분기
일반적인 프로그래밍 언어에서는 if문과 switch문을 사용해 조건 분기를 수행한다. SQL에서도 조건 분기를 수행할 수 있지만, 문장이 아니라 '식' 단위로 처리한다. SQL에서 조건 분기를 수행하는 대표적인 기능이 CASE 식이다.

#### CASE 식의 구문
CASE 식에는 **'단순 CASE 식'**과 **'검색 CASE 식'**이 있다. 검색 CASE 식은 단순 CASE 식의 기능을 포함하므로, 검색 CASE 식만 기억해도 충분하다. WHEN 구의 평가식은 `'필드=값'` 형태로 조건을 지정하며, WHERE 구의 조건 작성 방식과 유사하다.

#### CASE 식의 작동 방식
CASE 식은 switch 조건문과 유사하게 동작한다. WHEN 구의 평가식을 순차적으로 확인하고 조건이 맞는 경우 해당 THEN 구에서 지정한 값을 리턴하며 종료된다. 조건이 맞지 않으면 다음 WHEN 구로 이동하며, 끝까지 조건이 맞지 않으면 ELSE에서 지정한 값이 리턴된다.

SQL의 조건 분기는 절차 지향형 언어와 다르게 특정한 값을 리턴하는 점이 특징이다. 또한, CASE 식은 SELECT, WHERE, GROUP BY, HAVING, ORDER BY 구문 어디에나 활용할 수 있으며, SQL 성능과도 밀접한 관련이 있다.



### SQL의 집합 연산
SQL에서는 테이블을 집합으로 간주하고 연산할 수 있다. 대표적인 집합 연산에는 UNION(합집합), INTERSECT(교집합), EXCEPT(차집합)이 있다.

#### UNION으로 합집합 구하기
UNION 연산자는 두 개의 테이블을 하나로 합치는 기능을 한다. 기본적으로 중복된 레코드는 제거되며, 중복을 허용하고 싶다면 'UNION ALL'을 사용하면 된다.

#### INTERSECT로 교집합 구하기
INTERSECT 연산자는 두 테이블 간의 공통된 레코드만 반환한다. 이때 중복된 값은 자동으로 제거된다.

#### EXCEPT로 차집합 구하기
EXCEPT 연산자는 첫 번째 테이블에서 두 번째 테이블에 존재하는 레코드를 제외한 결과를 반환한다. 이 연산자는 순서에 따라 결과가 달라지므로 주의해야 한다.



### 윈도우 함수
윈도우 함수는 데이터를 그룹화하면서도 개별 행을 유지하는 기능을 한다. GROUP BY 구문과 다르게 집약 연산 없이 데이터를 자르기만 한다.

윈도우 함수는 PARTITION BY 구를 사용해 데이터를 그룹화하며, SELECT 구문 내에서 사용된다. 기본적인 구문은 집약 함수 뒤에 OVER 구를 작성하고, 내부에 PARTITION BY나 ORDER BY를 입력하는 방식이다.


### 트랜잭션과 갱신
SQL은 데이터 검색을 중심으로 설계된 언어지만, 데이터를 갱신하는 기능도 제공한다. 데이터 갱신 작업은 INSERT(삽입), DELETE(삭제), UPDATE(갱신) 세 가지로 분류된다. 추가적으로 MERGE(INSERT+UPDATE) 연산도 존재한다.


#### INSERT로 데이터 삽입
INSERT 구문을 사용해 테이블에 데이터를 삽입한다. 필드 리스트와 값 리스트는 동일한 순서로 입력해야 한다. 순서가 다르면 오류가 발생하거나 예상과 다른 값이 삽입될 수 있다.


#### DELETE로 데이터 제거
DELETE 구문을 사용해 데이터를 삭제한다. 특정 레코드만 삭제하려면 WHERE 구를 활용한다. DELETE 구문에서 필드명을 잘못 사용하면 오류가 발생하며 일부 필드만 삭제하는 것은 불가능하다.


#### UPDATE로 데이터 갱신
UPDATE 구문을 사용해 테이블 데이터를 수정한다. 특정 레코드만 갱신하려면 WHERE 구를 사용해 필터링해야 한다.